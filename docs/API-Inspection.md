# FAQ 엔드포인트 기능 및 로직 정리

## 1. 엔드포인트 개요
FAQ 관련 작업을 수행하기 위한 엔드포인트로, 다음과 같은 주요 기능을 제공합니다:
- **FAQ 생성**: 새로운 FAQ를 추가
- **FAQ 수정**: 기존 FAQ를 업데이트
- **FAQ 삭제**: 특정 FAQ를 삭제
- **FAQ 목록 조회**: 전체 FAQ 또는 특정 카테고리의 FAQ를 조회
- **FAQ 단일 조회**: 특정 ID를 기반으로 FAQ를 조회
- **FAQ 검색**: 키워드를 기반으로 FAQ를 검색
- **파일 다운로드**: 특정 파일을 다운로드

이 모든 기능은 보안이 적용되어 있으며, 관리자 권한이 필요한 작업은 헤더의 토큰을 기반으로 인증됩니다.

---

## 2. 엔드포인트 상세 설명

### 2.1 FAQ 생성
**엔드포인트:**
```
POST /faqs
```

**필요 권한:** 관리자

**요청 헤더:**
- Authorization: Bearer {토큰}

**요청 데이터:**
```json
{
  "category": "FAQ 카테고리",
  "question": "질문 내용",
  "answer": "답변 내용",
  "files": ["파일1", "파일2", ...]
}
```

**응답 데이터:**
```json
{
  "id": "FAQ ID",
  "category": "FAQ 카테고리",
  "question": "질문 내용",
  "answer": "답변 내용",
  "imageUrls": ["이미지 URL1", "이미지 URL2", ...]
}
```

**기능:**
1. 요청 데이터를 기반으로 FAQ를 생성.
2. 첨부 파일이 있을 경우 저장 경로를 생성하고 파일 저장.
3. 저장된 파일 경로를 기반으로 답변(`answer`)의 이미지 경로 업데이트.
4. 생성된 FAQ의 정보를 반환.

---

### 2.2 FAQ 수정
**엔드포인트:**
```
PUT /faqs/{id}
```

**필요 권한:** 관리자

**요청 헤더:**
- Authorization: Bearer {토큰}

**요청 데이터:**
```json
{
  "category": "FAQ 카테고리",
  "question": "질문 내용",
  "answer": "답변 내용",
  "existingImageUrls": ["기존 이미지 URL1", "기존 이미지 URL2", ...],
  "newFiles": ["새 파일1", "새 파일2", ...]
}
```

**응답 데이터:**
```json
{
  "id": "FAQ ID",
  "category": "FAQ 카테고리",
  "question": "질문 내용",
  "answer": "수정된 답변 내용",
  "imageUrls": ["이미지 URL1", "이미지 URL2", ...]
}
```

**기능:**
1. FAQ ID를 기반으로 데이터를 조회.
2. 수정 요청 데이터에 포함되지 않은 기존 이미지를 삭제.
3. 새 파일이 있을 경우 저장 후 이미지 경로를 업데이트.
4. 수정된 FAQ 정보를 반환.

---

### 2.3 FAQ 삭제
**엔드포인트:**
```
DELETE /faqs/{id}
```

**필요 권한:** 관리자

**요청 헤더:**
- Authorization: Bearer {토큰}

**응답 데이터:**
- 상태 코드 204 (No Content)

**기능:**
1. FAQ ID를 기반으로 데이터를 조회.
2. 관련된 모든 이미지를 삭제.
3. FAQ 데이터를 삭제.

---

### 2.4 FAQ 목록 조회
**엔드포인트:**
```
GET /faqs
```

**필요 권한:** 없음

**요청 파라미터:**
- `category` (선택): 조회할 FAQ 카테고리

**응답 데이터:**
```json
{
  "content": [
    {
      "id": "FAQ ID",
      "category": "FAQ 카테고리",
      "question": "질문 내용",
      "answer": "답변 내용",
      "imageUrls": ["이미지 URL1", "이미지 URL2", ...]
    },
    ...
  ],
  "pageable": { ... },
  "totalElements": 총 항목 수,
  "totalPages": 총 페이지 수
}
```

**기능:**
1. 카테고리가 지정되면 해당 카테고리의 FAQ를 페이징 처리하여 반환.
2. 카테고리가 없으면 전체 FAQ를 페이징 처리하여 반환.

---

### 2.5 FAQ 단일 조회
**엔드포인트:**
```
GET /faqs/{id}
```

**필요 권한:** 없음

**응답 데이터:**
```json
{
  "id": "FAQ ID",
  "category": "FAQ 카테고리",
  "question": "질문 내용",
  "answer": "답변 내용",
  "imageUrls": ["이미지 URL1", "이미지 URL2", ...]
}
```

**기능:**
1. ID를 기반으로 FAQ를 조회.
2. 조회된 데이터를 반환.

---

### 2.6 FAQ 검색
**엔드포인트:**
```
GET /faqs/search
```

**필요 권한:** 없음

**요청 파라미터:**
- `keyword` (필수): 검색 키워드

**응답 데이터:**
```json
{
  "content": [
    {
      "id": "FAQ ID",
      "category": "FAQ 카테고리",
      "question": "질문 내용",
      "answer": "답변 내용",
      "imageUrls": ["이미지 URL1", "이미지 URL2", ...]
    },
    ...
  ],
  "pageable": { ... },
  "totalElements": 총 항목 수,
  "totalPages": 총 페이지 수
}
```

**기능:**
1. 키워드를 기반으로 FAQ를 검색.
2. 검색된 데이터를 페이징 처리하여 반환.

---

### 2.7 FAQ 파일 다운로드
**엔드포인트:**
```
GET /faqs/files/{fileName}
```

**필요 권한:** 없음

**응답 데이터:**
- 파일 데이터 (Content-Type 및 파일 이름 포함)

**기능:**
1. 파일 이름을 기반으로 저장된 파일을 반환.
2. 파일이 없거나 읽을 수 없는 경우 적절한 상태 코드 반환 (404 또는 500).

---

## 3. FAQ 카테고리
FAQ는 다음 카테고리로 구분됩니다:
- **POLICY**: 이용 정책
- **GENERAL**: 공통
- **BUYING**: 구매
- **SELLING**: 판매

---

# Inspection 엔드포인트 기능 및 로직 정리

## 1. 엔드포인트 개요
Inspection(검수 기준) 관련 작업을 수행하기 위한 엔드포인트로, 다음과 같은 주요 기능을 제공합니다:
- **검수 기준 생성**: 새로운 검수 기준을 추가
- **검수 기준 수정**: 기존 검수 기준을 업데이트
- **검수 기준 삭제**: 특정 검수 기준을 삭제
- **검수 기준 목록 조회**: 전체 검수 기준 또는 특정 카테고리의 검수 기준을 조회
- **검수 기준 단일 조회**: 특정 ID를 기반으로 검수 기준을 조회
- **검수 기준 파일 다운로드**: 특정 파일을 다운로드

이 모든 기능은 보안이 적용되어 있으며, 관리자 권한이 필요한 작업은 헤더의 토큰을 기반으로 인증됩니다.

---

## 2. 엔드포인트 상세 설명

### 2.1 검수 기준 생성
**엔드포인트:**
```
POST /inspections
```

**필요 권한:** 관리자

**요청 헤더:**
- Authorization: Bearer {토큰}

**요청 데이터:**
```json
{
  "category": "검수 기준 카테고리",
  "content": "검수 기준 내용",
  "files": ["파일1", "파일2", ...]
}
```

**응답 데이터:**
```json
{
  "id": "검수 기준 ID",
  "category": "검수 기준 카테고리",
  "content": "검수 기준 내용",
  "imageUrls": ["이미지 URL1", "이미지 URL2", ...]
}
```

**기능:**
1. 요청 데이터를 기반으로 검수 기준을 생성.
2. 첨부 파일이 있을 경우 저장 경로를 생성하고 파일 저장.
3. 저장된 파일 경로를 기반으로 내용(`content`)의 이미지 경로 업데이트.
4. 생성된 검수 기준 정보를 반환.

---

### 2.2 검수 기준 수정
**엔드포인트:**
```
PUT /inspections/{id}
```

**필요 권한:** 관리자

**요청 헤더:**
- Authorization: Bearer {토큰}

**요청 데이터:**
```json
{
  "category": "검수 기준 카테고리",
  "content": "검수 기준 내용",
  "existingImageUrls": ["기존 이미지 URL1", "기존 이미지 URL2", ...],
  "newFiles": ["새 파일1", "새 파일2", ...]
}
```

**응답 데이터:**
```json
{
  "id": "검수 기준 ID",
  "category": "검수 기준 카테고리",
  "content": "수정된 검수 기준 내용",
  "imageUrls": ["이미지 URL1", "이미지 URL2", ...]
}
```

**기능:**
1. 검수 기준 ID를 기반으로 데이터를 조회.
2. 수정 요청 데이터에 포함되지 않은 기존 이미지를 삭제.
3. 새 파일이 있을 경우 저장 후 이미지 경로를 업데이트.
4. 수정된 검수 기준 정보를 반환.

---

### 2.3 검수 기준 삭제
**엔드포인트:**
```
DELETE /inspections/{id}
```

**필요 권한:** 관리자

**요청 헤더:**
- Authorization: Bearer {토큰}

**응답 데이터:**
- 상태 코드 204 (No Content)

**기능:**
1. 검수 기준 ID를 기반으로 데이터를 조회.
2. 관련된 모든 이미지를 삭제.
3. 검수 기준 데이터를 삭제.

---

### 2.4 검수 기준 목록 조회
**엔드포인트:**
```
GET /inspections
```

**필요 권한:** 없음

**요청 파라미터:**
- `category` (선택): 조회할 검수 기준 카테고리

**응답 데이터:**
```json
{
  "content": [
    {
      "id": "검수 기준 ID",
      "category": "검수 기준 카테고리",
      "content": "검수 기준 내용",
      "imageUrls": ["이미지 URL1", "이미지 URL2", ...]
    },
    ...
  ],
  "pageable": { ... },
  "totalElements": 총 항목 수,
  "totalPages": 총 페이지 수
}
```

**기능:**
1. 카테고리가 지정되면 해당 카테고리의 검수 기준을 페이징 처리하여 반환.
2. 카테고리가 없으면 전체 검수 기준을 페이징 처리하여 반환.

---

### 2.5 검수 기준 단일 조회
**엔드포인트:**
```
GET /inspections/{id}
```

**필요 권한:** 없음

**응답 데이터:**
```json
{
  "id": "검수 기준 ID",
  "category": "검수 기준 카테고리",
  "content": "검수 기준 내용",
  "imageUrls": ["이미지 URL1", "이미지 URL2", ...]
}
```

**기능:**
1. ID를 기반으로 검수 기준을 조회.
2. 조회된 데이터를 반환.

---

### 2.6 검수 기준 파일 다운로드
**엔드포인트:**
```
GET /inspections/files/{fileName}
```

**필요 권한:** 없음

**응답 데이터:**
- 파일 데이터 (Content-Type 및 파일 이름 포함)

**기능:**
1. 파일 이름을 기반으로 저장된 파일을 반환.
2. 파일이 없거나 읽을 수 없는 경우 적절한 상태 코드 반환 (404 또는 500).


---

## 3. 검수 기준 카테고리
Inspection은 다음 카테고리로 구분됩니다:
- **SHOES**: 신발
- **OUTER**: 아우터
- **BAG**: 가방
- **TECH**: 테크
- **BEAUTY**: 뷰티
- **PREMIUM_WATCH**: 프리미엄 시계
- **PREMIUM_BAG**: 프리미엄 가방

---

## 4. 보안 및 인증
1. **관리자 권한 확인**:
   - `Authorization` 헤더에 포함된 JWT 토큰을 기반으로 사용자의 이메일을 추출.
   - 이메일을 기반으로 사용자가 관리자 권한을 가지고 있는지 확인.
2. **파일 저장 경로**:
   - 파일은 `System.getProperty("user.dir") + "/InspectionFiles/"` 경로에 저장 및 관리.
